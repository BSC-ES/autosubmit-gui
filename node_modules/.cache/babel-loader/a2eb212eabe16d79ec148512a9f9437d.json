{"ast":null,"code":"import _classCallCheck from\"/Users/BleuDChan/ReposBSC/autosubmitreact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/BleuDChan/ReposBSC/autosubmitreact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/BleuDChan/ReposBSC/autosubmitreact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/BleuDChan/ReposBSC/autosubmitreact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";// import vis from \"vis-network\";\nimport Spinner from\"../layout/Spinner\";import vis from\"vis-network\";import{DEBUG}from\"../context/vars\";var GraphNativeRep=/*#__PURE__*/function(_Component){_inherits(GraphNativeRep,_Component);var _super=_createSuper(GraphNativeRep);function GraphNativeRep(){_classCallCheck(this,GraphNativeRep);return _super.apply(this,arguments);}_createClass(GraphNativeRep,[{key:\"shouldComponentUpdate\",value:function shouldComponentUpdate(nextProps,nextState){if(this.props.shouldUpdateGraph===true){//console.log(\"should Rerender\")\nreturn true;}else if(nextProps.data&&this.props.data&&nextProps.data.pkl_timestamp!==this.props.data.pkl_timestamp){//console.log(\"Rerendering\")\nreturn true;}else if(nextProps.loadingGraph!==this.props.loadingGraph){//console.log(\"Render because changed loading\")\nreturn true;}else{//console.log(\"NO RERENDER\")\nreturn false;}}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){DEBUG&&console.log(\"Unmounting Nav Rep\");this.props.cleanGraphData();this.props.clearStats();}},{key:\"render\",value:function render(){if(this.props.loadingGraph)return/*#__PURE__*/React.createElement(Spinner,null);if(!this.props.data){return/*#__PURE__*/React.createElement(\"div\",{className:\"card-body text-left\",style:experimentStyle},/*#__PURE__*/React.createElement(\"p\",{className:\"lead\"},\"Press \",/*#__PURE__*/React.createElement(\"span\",{className:\"badge badge-info\"},\"Classic\"),\" to see the standard graph representation of the experiment.\"),/*#__PURE__*/React.createElement(\"p\",null,\"For the classic approach, the algorithm will first try to use graphviz, there are some constraints in place that try to identify those instances that could potentially make graphviz run forever. If an experiment is identified to be time-wise out of bounds for graphviz, it will be sent to the regular algorithm. Currently, the regular algorithm does not handle well wrappers; work is being done to developed a general algorithm.\"),/*#__PURE__*/React.createElement(\"p\",{className:\"lead\"},\"Press \",/*#__PURE__*/React.createElement(\"span\",{className:\"badge badge-info\"},\"Grouped\"),\" to see the grouped by date-member graph representation of the experiment.\"),/*#__PURE__*/React.createElement(\"p\",null,\"If the experiment instance cannot be handled by graphviz, then it would not be possible to group it. Again, work is being done to overcome this.\"),/*#__PURE__*/React.createElement(\"p\",{className:\"lead\"},\"If the experiment is\",\" \",/*#__PURE__*/React.createElement(\"span\",{className:\"badge badge-success\"},\"RUNNING\"),\" and the Graph has been rendered, press\",\" \",/*#__PURE__*/React.createElement(\"span\",{className:\"badge badge-dark\"},\"Start Job Monitor\"),\" to start a live tracker of the changes on the experiment's jobs. This process will automatically update the graph's nodes colors and show a log of the detected changes.\"),/*#__PURE__*/React.createElement(\"p\",{className:\"lead\"},\"If there are any defined wrappers, they will be shown on the corresponding tab at the right side of the Graph. You can click on any member of that list and the nodes belonging to that wrapper will be highlighted.\"));}var nodes_array=[];var edges_array=[];var graphviz=this.props.data.graphviz;var groups=this.props.data.groups;var groups_data=this.props.data.groups_data;var current_grouped=this.props.current_grouped;if(this.props.data.nodes.length>0&&this.props.data.edges!==null){if(graphviz===true){this.props.data.nodes.map(function(node){return nodes_array.push({id:node.id,label:node.label,shape:node.shape,color:{background:node.status_color,border:\"black\"},status:node.status,// level: node.level, // receiving x and y from API\n// fixed: { x: true, y: true},\nx:node.x,y:node.y,shapeProperties:{borderDashes:node.dashed}});});}else{this.props.data.nodes.map(function(node){return nodes_array.push({id:node.id,label:node.label,shape:node.shape,color:{background:node.status_color,border:\"black\"},status:node.status,//level: node.level,\n//y: node.level*80,\nshapeProperties:{borderDashes:node.dashed},// fixed: { x: true, y: true},\nx:node.x,y:node.y// x: node.x * -90,\n// y: node.y * -100,\n});});}if(this.props.data.edges){this.props.data.edges.map(function(edge){return edges_array.push({id:edge.id,from:edge.from,to:edge.to,dashes:edge.dashed,background:{enabled:edge.is_wrapper,color:\"rgba(63, 191, 63, 0.5)\"},arrows:{to:{enabled:!edge.dashed}}});});}if(this.props.data.fake_edges){this.props.data.fake_edges.map(function(edge){return edges_array.push({id:edge.id,from:edge.from,to:edge.to,dashes:edge.dashed,background:{enabled:edge.is_wrapper,color:\"rgba(63, 191, 63, 0.5)\"},arrows:{to:{enabled:!edge.dashed}}});});}}else{return/*#__PURE__*/React.createElement(\"div\",{className:\"card-body text-left\",style:experimentStyle},/*#__PURE__*/React.createElement(\"p\",{className:\"lead\"},\"Something has gone very wrong.\"),/*#__PURE__*/React.createElement(\"p\",{className:\"lead text-danger\"},this.props.data.error_message));}var nodes=new vis.DataSet(nodes_array);var edges=new vis.DataSet(edges_array);var shouldEdge=false;if(this.props.data.total_jobs<=500){shouldEdge=true;}var options={autoResize:true,edges:{arrows:{to:{enabled:true}}},layout:{improvedLayout:false,hierarchical:{nodeSpacing:190,blockShifting:false,edgeMinimization:shouldEdge,parentCentralization:true,sortMethod:\"hubsize\",direction:\"UD\",enabled:false}},interaction:{dragNodes:true,hoverConnectedEdges:true,hideEdgesOnDrag:true,//hideEdgesOnZoom: true,\nmultiselect:true,navigationButtons:true},physics:{enabled:false,stabilization:{// Determines an initial layout; enabled by default\nenabled:true,iterations:1000}},nodes:{shape:\"dot\",font:{size:10}}};var graph={nodes:nodes,edges:edges};var VisNetwork=/*#__PURE__*/function(_Component2){_inherits(VisNetwork,_Component2);var _super2=_createSuper(VisNetwork);function VisNetwork(){_classCallCheck(this,VisNetwork);return _super2.apply(this,arguments);}_createClass(VisNetwork,[{key:\"shouldComponentUpdate\",value:function shouldComponentUpdate(nextProps,nextState){if(this.props.shouldUpdateGraph===true){DEBUG&&console.log(\"Should rerender form inside\");return true;}else{//console.log(\"No RERENDER\")\nDEBUG&&console.log(\"No rerender\");return false;}}},{key:\"componentDidMount\",value:function componentDidMount(){var _this=this;var network=new vis.Network(this.refs.myRef,this.props.graph,this.props.options);var groups_data=this.props.groups_data;var current_grouped=this.props.current_grouped;this.props.setVisNetwork(network);network.on(\"select\",function(params){if(params.nodes){if(params.nodes.length===1){if(network.isCluster(params.nodes[0])){}else{//console.log(params.nodes);\n_this.props.updateSelection(params.nodes);// this.props.updateGraphSelectedNodes(params.nodes);\n_this.props.updateCurrentSelected(params.nodes[0],_this.props.data);}}// } else {\n//   this.props.updateSelection(params.nodes);\n// }\n}});// network.on(\"stabilized\", () => {\n//   this.props.navigateAfterLoadGraph(this.props.experimentRunning);\n// });\nnetwork.on(\"doubleClick\",function(params){if(params.nodes){if(params.nodes.length===1){if(network.isCluster(params.nodes[0])){var OpenClusterObj={};OpenClusterObj.releaseFunction=function(clusterPosition,containedNodesPositions){return containedNodesPositions;};network.openCluster(params.nodes[0],OpenClusterObj);}}}});//network.enableEditMode();\n//console.log(this.props.isGraphViz);\nif(this.props.clusterGroups){var _groups=this.props.clusterGroups;if(current_grouped===\"date-member\"){var clusterOptionsByDateMember;for(var i=0;i<_groups.length;i++){var startingName=_groups[i];// if (positions[startingName]){\n//   console.log(positions[startingName]);\n// }\nclusterOptionsByDateMember={// eslint-disable-next-line no-loop-func\njoinCondition:function joinCondition(options){return options.id.startsWith(startingName);},processProperties:function processProperties(clusterOptions,childNodes,childEdges){var totalMass=0;for(var i=0;i<childNodes.length;i++){totalMass+=childNodes[i].mass;}clusterOptions.mass=totalMass;return clusterOptions;},clusterNodeProperties:{id:\"cluster:\"+startingName,borderWidth:3,shape:\"box\",label:startingName.split(\"_\").join(\"\\n\"),color:groups_data[startingName].color,font:{size:50},x:groups_data[startingName].x,y:groups_data[startingName].y}};network.clustering.cluster(clusterOptionsByDateMember);}}else if(current_grouped===\"status\"){var clusterOptionsByStatus;for(var j=0;j<_groups.length;j++){var statusName=_groups[j];// console.log(statusName);\nclusterOptionsByStatus={// eslint-disable-next-line no-loop-func\njoinCondition:function joinCondition(options){// console.log(options);\nreturn options.status===statusName&&options.shape===\"dot\";},processProperties:function processProperties(clusterOptions,childNodes,childEdges){var totalMass=0;for(var i=0;i<childNodes.length;i++){totalMass+=childNodes[i].mass;}clusterOptions.mass=totalMass;return clusterOptions;},clusterNodeProperties:{id:statusName,borderWidth:3,shape:\"box\",label:statusName,color:groups_data[statusName].color,font:{size:50}}};network.clustering.cluster(clusterOptionsByStatus);}}}this.props.navigateAfterLoadGraph(this.props.experimentRunning);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){DEBUG&&console.log(\"Unmounting VisNetwork\");this.props.cleanNavData();}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",{className:\"card-body p-0\"},/*#__PURE__*/React.createElement(\"div\",{id:\"graphrep\",ref:\"myRef\",style:experimentStyle}));}}]);return VisNetwork;}(Component);return/*#__PURE__*/React.createElement(VisNetwork,{data:this.props.data,graph:graph,options:options,updateSelection:this.props.updateSelection,shouldUpdateGraph:this.props.shouldUpdateGraph,setVisNetwork:this.props.setVisNetwork,cleanNavData:this.props.cleanNavData,isGraphViz:graphviz,clusterGroups:groups,groups_data:groups_data,current_grouped:current_grouped,experimentRunning:this.props.experimentRunning,navigateAfterLoadGraph:this.props.navigateAfterLoadGraph,updateCurrentSelected:this.props.updateCurrentSelected,updateGraphSelectedNodes:this.props.updateGraphSelectedNodes});}}]);return GraphNativeRep;}(Component);var experimentStyle={height:755};export default GraphNativeRep;","map":{"version":3,"sources":["/Users/BleuDChan/ReposBSC/autosubmitreact/src/components/experiment/GraphNativeRep.js"],"names":["React","Component","Spinner","vis","DEBUG","GraphNativeRep","nextProps","nextState","props","shouldUpdateGraph","data","pkl_timestamp","loadingGraph","console","log","cleanGraphData","clearStats","experimentStyle","nodes_array","edges_array","graphviz","groups","groups_data","current_grouped","nodes","length","edges","map","node","push","id","label","shape","color","background","status_color","border","status","x","y","shapeProperties","borderDashes","dashed","edge","from","to","dashes","enabled","is_wrapper","arrows","fake_edges","error_message","DataSet","shouldEdge","total_jobs","options","autoResize","layout","improvedLayout","hierarchical","nodeSpacing","blockShifting","edgeMinimization","parentCentralization","sortMethod","direction","interaction","dragNodes","hoverConnectedEdges","hideEdgesOnDrag","multiselect","navigationButtons","physics","stabilization","iterations","font","size","graph","VisNetwork","network","Network","refs","myRef","setVisNetwork","on","params","isCluster","updateSelection","updateCurrentSelected","OpenClusterObj","releaseFunction","clusterPosition","containedNodesPositions","openCluster","clusterGroups","clusterOptionsByDateMember","i","startingName","joinCondition","startsWith","processProperties","clusterOptions","childNodes","childEdges","totalMass","mass","clusterNodeProperties","borderWidth","split","join","clustering","cluster","clusterOptionsByStatus","j","statusName","navigateAfterLoadGraph","experimentRunning","cleanNavData","updateGraphSelectedNodes","height"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\n// import vis from \"vis-network\";\nimport Spinner from \"../layout/Spinner\";\nimport vis from \"vis-network\";\nimport { DEBUG } from \"../context/vars\";\nclass GraphNativeRep extends Component {\n  shouldComponentUpdate(nextProps, nextState) {\n    if (this.props.shouldUpdateGraph === true) {\n      //console.log(\"should Rerender\")\n      return true;\n    } else if (\n      nextProps.data &&\n      this.props.data &&\n      nextProps.data.pkl_timestamp !== this.props.data.pkl_timestamp\n    ) {\n      //console.log(\"Rerendering\")\n      return true;\n    } else if (nextProps.loadingGraph !== this.props.loadingGraph) {\n      //console.log(\"Render because changed loading\")\n      return true;\n    } else {\n      //console.log(\"NO RERENDER\")\n      return false;\n    }\n  }\n\n  componentWillUnmount() {\n    DEBUG && console.log(\"Unmounting Nav Rep\");\n    this.props.cleanGraphData();\n    this.props.clearStats();\n  }\n\n  render() {\n    if (this.props.loadingGraph) return <Spinner></Spinner>;\n    if (!this.props.data) {\n      return (\n        <div className='card-body text-left' style={experimentStyle}>\n          <p className='lead'>\n            Press <span className='badge badge-info'>Classic</span> to see the\n            standard graph representation of the experiment.\n          </p>\n          <p>\n            For the classic approach, the algorithm will first try to use\n            graphviz, there are some constraints in place that try to identify\n            those instances that could potentially make graphviz run forever. If\n            an experiment is identified to be time-wise out of bounds for\n            graphviz, it will be sent to the regular algorithm. Currently, the\n            regular algorithm does not handle well wrappers; work is being done\n            to developed a general algorithm.\n          </p>\n          <p className='lead'>\n            Press <span className='badge badge-info'>Grouped</span> to see the\n            grouped by date-member graph representation of the experiment.\n          </p>\n          <p>\n            If the experiment instance cannot be handled by graphviz, then it\n            would not be possible to group it. Again, work is being done to\n            overcome this.\n          </p>\n          <p className='lead'>\n            If the experiment is{\" \"}\n            <span className='badge badge-success'>RUNNING</span> and the Graph\n            has been rendered, press{\" \"}\n            <span className='badge badge-dark'>Start Job Monitor</span> to start\n            a live tracker of the changes on the experiment's jobs. This process\n            will automatically update the graph's nodes colors and show a log of\n            the detected changes.\n          </p>\n          <p className='lead'>\n            If there are any defined wrappers, they will be shown on the\n            corresponding tab at the right side of the Graph. You can click on\n            any member of that list and the nodes belonging to that wrapper will\n            be highlighted.\n          </p>\n        </div>\n      );\n    }\n\n    var nodes_array = [];\n    var edges_array = [];\n    const graphviz = this.props.data.graphviz;\n    const groups = this.props.data.groups;\n    const groups_data = this.props.data.groups_data;\n    const current_grouped = this.props.current_grouped;\n\n    if (this.props.data.nodes.length > 0 && this.props.data.edges !== null) {\n      if (graphviz === true) {\n        this.props.data.nodes.map((node) =>\n          nodes_array.push({\n            id: node.id,\n            label: node.label,\n            shape: node.shape,\n            color: { background: node.status_color, border: \"black\" },\n            status: node.status,\n            // level: node.level, // receiving x and y from API\n            // fixed: { x: true, y: true},\n            x: node.x,\n            y: node.y,\n            shapeProperties: { borderDashes: node.dashed },\n          })\n        );\n      } else {\n        this.props.data.nodes.map((node) =>\n          nodes_array.push({\n            id: node.id,\n            label: node.label,\n            shape: node.shape,\n            color: { background: node.status_color, border: \"black\" },\n            status: node.status,\n            //level: node.level,\n            //y: node.level*80,\n            shapeProperties: { borderDashes: node.dashed },\n            // fixed: { x: true, y: true},\n            x: node.x,\n            y: node.y,\n            // x: node.x * -90,\n            // y: node.y * -100,\n          })\n        );\n      }\n\n      if (this.props.data.edges) {\n        this.props.data.edges.map((edge) =>\n          edges_array.push({\n            id: edge.id,\n            from: edge.from,\n            to: edge.to,\n            dashes: edge.dashed,\n            background: {\n              enabled: edge.is_wrapper,\n              color: \"rgba(63, 191, 63, 0.5)\",\n            },\n            arrows: { to: { enabled: !edge.dashed } },\n          })\n        );\n      }\n\n      if (this.props.data.fake_edges) {\n        this.props.data.fake_edges.map((edge) =>\n          edges_array.push({\n            id: edge.id,\n            from: edge.from,\n            to: edge.to,\n            dashes: edge.dashed,\n            background: {\n              enabled: edge.is_wrapper,\n              color: \"rgba(63, 191, 63, 0.5)\",\n            },\n            arrows: { to: { enabled: !edge.dashed } },\n          })\n        );\n      }\n    } else {\n      return (\n        <div className='card-body text-left' style={experimentStyle}>\n          <p className='lead'>Something has gone very wrong.</p>\n          <p className='lead text-danger'>{this.props.data.error_message}</p>\n        </div>\n      );\n    }\n\n    var nodes = new vis.DataSet(nodes_array);\n    var edges = new vis.DataSet(edges_array);\n\n    var shouldEdge = false;\n    if (this.props.data.total_jobs <= 500) {\n      shouldEdge = true;\n    }\n    const options = {\n      autoResize: true,\n      edges: {\n        arrows: {\n          to: { enabled: true },\n        },\n      },\n      layout: {\n        improvedLayout: false,\n        hierarchical: {\n          nodeSpacing: 190,\n          blockShifting: false,\n          edgeMinimization: shouldEdge,\n          parentCentralization: true,\n          sortMethod: \"hubsize\",\n          direction: \"UD\",\n          enabled: false,\n        },\n      },\n      interaction: {\n        dragNodes: true,\n        hoverConnectedEdges: true,\n        hideEdgesOnDrag: true,\n        //hideEdgesOnZoom: true,\n        multiselect: true,\n        navigationButtons: true,\n      },\n      physics: {\n        enabled: false,\n        stabilization: {\n          // Determines an initial layout; enabled by default\n          enabled: true,\n          iterations: 1000,\n        },\n      },\n      nodes: {\n        shape: \"dot\",\n        font: {\n          size: 10,\n        },\n      },\n    };\n\n    const graph = {\n      nodes: nodes,\n      edges: edges,\n    };\n\n    class VisNetwork extends Component {\n\n      shouldComponentUpdate(nextProps, nextState) {\n        if (this.props.shouldUpdateGraph === true) {\n          DEBUG && console.log(\"Should rerender form inside\");\n          return true;\n        } else {\n          //console.log(\"No RERENDER\")\n          DEBUG && console.log(\"No rerender\");\n          return false;\n        }\n      }\n\n      componentDidMount() {\n        let network = new vis.Network(\n          this.refs.myRef,\n          this.props.graph,\n          this.props.options\n        );\n        const groups_data = this.props.groups_data;\n        const current_grouped = this.props.current_grouped;\n\n        this.props.setVisNetwork(network);\n        network.on(\"select\", (params) => {\n          if (params.nodes) {\n            if (params.nodes.length === 1) {\n              if (network.isCluster(params.nodes[0])) {\n              } else {\n                //console.log(params.nodes);\n                this.props.updateSelection(params.nodes);\n                // this.props.updateGraphSelectedNodes(params.nodes);\n                this.props.updateCurrentSelected(\n                  params.nodes[0],\n                  this.props.data\n                );\n              }\n            }\n            // } else {\n            //   this.props.updateSelection(params.nodes);\n            // }\n          }\n        });\n\n        // network.on(\"stabilized\", () => {\n        //   this.props.navigateAfterLoadGraph(this.props.experimentRunning);\n        // });\n\n        network.on(\"doubleClick\", (params) => {\n          if (params.nodes) {\n            if (params.nodes.length === 1) {\n              if (network.isCluster(params.nodes[0])) {\n                var OpenClusterObj = {};\n                OpenClusterObj.releaseFunction = function (\n                  clusterPosition,\n                  containedNodesPositions\n                ) {\n                  return containedNodesPositions;\n                };\n                network.openCluster(params.nodes[0], OpenClusterObj);\n              }\n            }\n          }\n        });\n\n        //network.enableEditMode();\n        //console.log(this.props.isGraphViz);\n        if (this.props.clusterGroups) {\n          const groups = this.props.clusterGroups;\n          if (current_grouped === \"date-member\") {\n            var clusterOptionsByDateMember;\n            for (var i = 0; i < groups.length; i++) {\n              var startingName = groups[i];\n              // if (positions[startingName]){\n              //   console.log(positions[startingName]);\n              // }\n              clusterOptionsByDateMember = {\n                // eslint-disable-next-line no-loop-func\n                joinCondition: function (options) {\n                  return options.id.startsWith(startingName);\n                },\n                processProperties: function (\n                  clusterOptions,\n                  childNodes,\n                  childEdges\n                ) {\n                  var totalMass = 0;\n                  for (var i = 0; i < childNodes.length; i++) {\n                    totalMass += childNodes[i].mass;\n                  }\n                  clusterOptions.mass = totalMass;\n                  return clusterOptions;\n                },\n                clusterNodeProperties: {\n                  id: \"cluster:\" + startingName,\n                  borderWidth: 3,\n                  shape: \"box\",\n                  label: startingName.split(\"_\").join(\"\\n\"),\n                  color: groups_data[startingName].color,\n                  font: { size: 50 },\n                  x: groups_data[startingName].x,\n                  y: groups_data[startingName].y,\n                },\n              };\n              network.clustering.cluster(clusterOptionsByDateMember);\n            }\n          } else if (current_grouped === \"status\") {\n            var clusterOptionsByStatus;\n            for (var j = 0; j < groups.length; j++) {\n              var statusName = groups[j];\n              // console.log(statusName);\n              clusterOptionsByStatus = {\n                // eslint-disable-next-line no-loop-func\n                joinCondition: function (options) {\n                  // console.log(options);\n                  return (\n                    options.status === statusName && options.shape === \"dot\"\n                  );\n                },\n                processProperties: function (\n                  clusterOptions,\n                  childNodes,\n                  childEdges\n                ) {\n                  var totalMass = 0;\n                  for (var i = 0; i < childNodes.length; i++) {\n                    totalMass += childNodes[i].mass;\n                  }\n                  clusterOptions.mass = totalMass;\n                  return clusterOptions;\n                },\n                clusterNodeProperties: {\n                  id: statusName,\n                  borderWidth: 3,\n                  shape: \"box\",\n                  label: statusName,\n                  color: groups_data[statusName].color,\n                  font: { size: 50 },\n                },\n              };\n              network.clustering.cluster(clusterOptionsByStatus);\n            }\n          }\n        }\n\n        this.props.navigateAfterLoadGraph(this.props.experimentRunning);\n      }\n\n      componentWillUnmount() {\n        DEBUG && console.log(\"Unmounting VisNetwork\");\n        this.props.cleanNavData();\n      }\n\n      render() {\n        return (\n          <div className='card-body p-0'>\n            <div id=\"graphrep\" ref='myRef' style={experimentStyle}></div>\n          </div>\n        );\n      }\n    }\n\n    return (\n      <VisNetwork\n        data={this.props.data}\n        graph={graph}\n        options={options}\n        updateSelection={this.props.updateSelection}\n        shouldUpdateGraph={this.props.shouldUpdateGraph}\n        setVisNetwork={this.props.setVisNetwork}\n        cleanNavData={this.props.cleanNavData}\n        isGraphViz={graphviz}\n        clusterGroups={groups}\n        groups_data={groups_data}\n        current_grouped={current_grouped}\n        experimentRunning={this.props.experimentRunning}\n        navigateAfterLoadGraph={this.props.navigateAfterLoadGraph}\n        updateCurrentSelected={this.props.updateCurrentSelected}\n        updateGraphSelectedNodes={this.props.updateGraphSelectedNodes}\n      />\n    );\n  }\n}\n\nconst experimentStyle = {\n  height: 755,\n};\n\nexport default GraphNativeRep;\n"]},"metadata":{},"sourceType":"module"}