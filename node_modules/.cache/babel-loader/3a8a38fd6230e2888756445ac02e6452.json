{"ast":null,"code":"var _jsxFileName = \"/Users/BleuDChan/ReposBSC/autosubmitreact/src/components/experiment/JobHistory.js\";\nimport React, { useContext } from \"react\";\nimport ExperimentContext from \"../context/experiment/experimentContext\";\nimport GraphContext from \"../context/graph/graphContext\";\nimport TreeContext from \"../context/tree/treeContext\";\nimport { exportHistoryToCSV } from \"../context/utils\";\n\nconst JobHistory = ({\n  source\n}) => {\n  const experimentContext = useContext(ExperimentContext);\n  const graphContext = useContext(GraphContext);\n  const treeContext = useContext(TreeContext);\n  const {\n    experiment,\n    jobHistory,\n    getJobHistory\n  } = experimentContext;\n  const {\n    selection\n  } = graphContext;\n  const {\n    selectedTreeNode\n  } = treeContext;\n  const {\n    db_historic_version,\n    expid\n  } = experiment;\n  const selectedJob = source === \"tree\" ? selectedTreeNode ? selectedTreeNode.node.refKey : null : source === \"graph\" ? selection && selection.length > 0 ? selection[0] : null : null;\n\n  const onGetJobHistory = e => {\n    e.preventDefault();\n    getJobHistory(expid, selectedJob);\n  };\n\n  const onExport = jobName => e => {\n    e.preventDefault();\n    const columnNames = [\"Counter\", \"JobId\", \"Submit\", \"Start\", \"Finish\", \"Queue\", \"Run\", \"Status\", \"Energy\", \"Wallclock\", \"NCpus\", \"Nnodes\"];\n    exportHistoryToCSV(jobHistory.history, columnNames, jobName + \"_history.csv\");\n  };\n\n  const dataTarget = \"history-\" + source;\n\n  if (experiment && selectedJob && db_historic_version && db_historic_version >= 12) {\n    return /*#__PURE__*/React.createElement(\"small\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 46,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn-sm btn-info my-0 py-0\",\n      type: \"button\",\n      onClick: onGetJobHistory,\n      \"data-toggle\": \"modal\",\n      \"data-target\": \"#\" + dataTarget,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 47,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"fas fa-history\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"modal fade text-dark\",\n      id: dataTarget,\n      tabIndex: \"-1\",\n      role: \"dialog\",\n      \"aria-labelledby\": dataTarget + \"Title\",\n      \"aria-hidden\": \"true\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"modal-dialog modal-dialog-historic\",\n      role: \"document\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"modal-content\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"modal-header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"h5\", {\n      className: \"modal-title\",\n      id: dataTarget + \"Title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 17\n      }\n    }, \"Historical data for \", /*#__PURE__*/React.createElement(\"strong\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 39\n      }\n    }, selectedJob)), \"\\xA0\", jobHistory && jobHistory.history && jobHistory.history.length > 0 && /*#__PURE__*/React.createElement(\"button\", {\n      type: \"button\",\n      className: \"btn-sm btn-primary\",\n      onClick: onExport(selectedJob),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"fas fa-file-export\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 102\n      }\n    })), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"close\",\n      type: \"button\",\n      \"data-dismiss\": \"modal\",\n      \"aria-label\": \"Close\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      \"aria-hidden\": \"true\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 19\n      }\n    }, \"\\xD7\"))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"modal-body\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 15\n      }\n    }, jobHistory && jobHistory.history && /*#__PURE__*/React.createElement(\"table\", {\n      className: \"table\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"thead\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      scope: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 25\n      }\n    }, \"Counter\"), /*#__PURE__*/React.createElement(\"th\", {\n      scope: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 25\n      }\n    }, \"JobId\"), /*#__PURE__*/React.createElement(\"th\", {\n      scope: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 25\n      }\n    }, \"Submit\"), /*#__PURE__*/React.createElement(\"th\", {\n      scope: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 25\n      }\n    }, \"Start\"), /*#__PURE__*/React.createElement(\"th\", {\n      scope: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 25\n      }\n    }, \"Finish\"), /*#__PURE__*/React.createElement(\"th\", {\n      scope: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 25\n      }\n    }, \"Queue\"), /*#__PURE__*/React.createElement(\"th\", {\n      scope: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 25\n      }\n    }, \"Run\"), /*#__PURE__*/React.createElement(\"th\", {\n      scope: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 25\n      }\n    }, \"Status\"), /*#__PURE__*/React.createElement(\"th\", {\n      scope: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 25\n      }\n    }, \"Energy\"), /*#__PURE__*/React.createElement(\"th\", {\n      scope: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 25\n      }\n    }, \"Wallclock\"), /*#__PURE__*/React.createElement(\"th\", {\n      scope: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 25\n      }\n    }, \"NCpus\"), /*#__PURE__*/React.createElement(\"th\", {\n      scope: \"col\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 25\n      }\n    }, \"NNodes\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 21\n      }\n    }, jobHistory.history.map(item => /*#__PURE__*/React.createElement(\"tr\", {\n      key: item.counter,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 27\n      }\n    }, item.counter), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 27\n      }\n    }, item.job_id), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 27\n      }\n    }, item.submit), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 27\n      }\n    }, item.start), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 27\n      }\n    }, item.finish), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 27\n      }\n    }, item.queue_time), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 27\n      }\n    }, item.run_time, \" \", item.run_time === \"0:00:00\" && /*#__PURE__*/React.createElement(\"span\", {\n      className: \"badge badge-warning\",\n      \"data-toggle\": \"tooltip\",\n      \"data-placement\": \"bottom\",\n      title: \"This running time value usually means that there has been some error either on the completion of the job or in the historical database storage process.\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 31\n      }\n    }, \"!\")), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 27\n      }\n    }, item.status), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 27\n      }\n    }, item.energy), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 27\n      }\n    }, item.wallclock), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 27\n      }\n    }, item.ncpus), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 27\n      }\n    }, item.nodes))))), jobHistory && jobHistory.history.length === 0 && /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 19\n      }\n    }, \"There is no historic data for this job. Are you running the latest version of Autosubmit that implements the historic database?\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"modal-footer\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"button\",\n      className: \"btn btn-secondary\",\n      \"data-dismiss\": \"modal\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 17\n      }\n    }, \"Close\"))))));\n  } else {\n    return null;\n  }\n};\n\nexport default JobHistory;","map":{"version":3,"sources":["/Users/BleuDChan/ReposBSC/autosubmitreact/src/components/experiment/JobHistory.js"],"names":["React","useContext","ExperimentContext","GraphContext","TreeContext","exportHistoryToCSV","JobHistory","source","experimentContext","graphContext","treeContext","experiment","jobHistory","getJobHistory","selection","selectedTreeNode","db_historic_version","expid","selectedJob","node","refKey","length","onGetJobHistory","e","preventDefault","onExport","jobName","columnNames","history","dataTarget","map","item","counter","job_id","submit","start","finish","queue_time","run_time","status","energy","wallclock","ncpus","nodes"],"mappings":"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","sourcesContent":["import React, { useContext } from \"react\";\nimport ExperimentContext from \"../context/experiment/experimentContext\";\nimport GraphContext from \"../context/graph/graphContext\";\nimport TreeContext from \"../context/tree/treeContext\";\nimport { exportHistoryToCSV } from \"../context/utils\";\n\nconst JobHistory = ({ source }) => {\n  const experimentContext = useContext(ExperimentContext);\n  const graphContext = useContext(GraphContext);\n  const treeContext = useContext(TreeContext);\n  const { experiment, jobHistory, getJobHistory } = experimentContext;\n  const { selection } = graphContext;\n  const { selectedTreeNode } = treeContext;\n  const { db_historic_version, expid } = experiment;\n  const selectedJob =\n    source === \"tree\"\n      ? selectedTreeNode\n        ? selectedTreeNode.node.refKey\n        : null\n      : source === \"graph\"\n      ? selection && selection.length > 0\n        ? selection[0]\n        : null\n      : null;\n\n  const onGetJobHistory = (e) => {\n    e.preventDefault();\n    getJobHistory(expid, selectedJob);\n  };\n\n  const onExport = (jobName) => (e) => {\n    e.preventDefault();    \n    const columnNames = [\"Counter\",\"JobId\",\"Submit\",\"Start\",\"Finish\",\"Queue\",\"Run\",\"Status\",\"Energy\",\"Wallclock\",\"NCpus\",\"Nnodes\"];    \n    exportHistoryToCSV(jobHistory.history,columnNames,jobName+\"_history.csv\");        \n  }\n\n  const dataTarget = \"history-\" + source;\n\n  if (\n    experiment &&\n    selectedJob &&\n    db_historic_version &&\n    db_historic_version >= 12\n  ) {\n    return (\n      <small>\n        <button\n          className='btn-sm btn-info my-0 py-0'\n          type='button'\n          onClick={onGetJobHistory}\n          data-toggle='modal'\n          data-target={\"#\" + dataTarget}\n        >\n          <i className='fas fa-history'></i>\n        </button>\n        <div\n          className='modal fade text-dark'\n          id={dataTarget}\n          tabIndex='-1'\n          role='dialog'\n          aria-labelledby={dataTarget + \"Title\"}\n          aria-hidden='true'\n        >\n          <div className='modal-dialog modal-dialog-historic' role='document'>\n            <div className='modal-content'>\n              <div className='modal-header'>\n                <h5 className='modal-title' id={dataTarget + \"Title\"}>\n                  Historical data for <strong>{selectedJob}</strong>\n                </h5>\n                &nbsp;\n                {jobHistory && jobHistory.history && jobHistory.history.length > 0 &&                \n                <button type=\"button\" className=\"btn-sm btn-primary\" onClick={onExport(selectedJob)}><i className=\"fas fa-file-export\"></i></button>\n                }                \n                <button\n                  className='close'\n                  type='button'\n                  data-dismiss='modal'\n                  aria-label='Close'\n                >\n                  <span aria-hidden='true'>&times;</span>\n                </button>\n              </div>\n              <div className='modal-body'>\n                {jobHistory && jobHistory.history && (\n                  <table className='table'>\n                    <thead>\n                      <tr>\n                        <th scope='col'>Counter</th>\n                        <th scope='col'>JobId</th>\n                        {/* <th scope='col'>Created</th> */}\n                        <th scope='col'>Submit</th>\n                        <th scope='col'>Start</th>\n                        <th scope='col'>Finish</th>\n                        <th scope='col'>Queue</th>\n                        <th scope='col'>Run</th>\n                        <th scope='col'>Status</th>\n                        <th scope='col'>Energy</th>\n                        <th scope='col'>Wallclock</th>\n                        <th scope='col'>NCpus</th>\n                        <th scope='col'>NNodes</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {jobHistory.history.map((item) => (\n                        <tr key={item.counter}>\n                          <td>{item.counter}</td>\n                          <td>{item.job_id}</td>\n                          {/* <td>{item.created}</td> */}\n                          <td>{item.submit}</td>\n                          <td>{item.start}</td>\n                          <td>{item.finish}</td>\n                          <td>{item.queue_time}</td>\n                          <td>\n                            {item.run_time}{\" \"}\n                            {item.run_time === \"0:00:00\" && (\n                              <span\n                                className='badge badge-warning'\n                                data-toggle='tooltip'\n                                data-placement='bottom'\n                                title='This running time value usually means that there has been some error either on the completion of the job or in the historical database storage process.'\n                              >\n                                !\n                              </span>\n                            )}\n                          </td>\n                          <td>{item.status}</td>\n                          <td>{item.energy}</td>\n                          <td>{item.wallclock}</td>\n                          <td>{item.ncpus}</td>\n                          <td>{item.nodes}</td>\n                        </tr>\n                      ))}\n                    </tbody>\n                  </table>\n                )}\n                {jobHistory && jobHistory.history.length === 0 && (\n                  <p>\n                    There is no historic data for this job. Are you running the\n                    latest version of Autosubmit that implements the historic\n                    database?\n                  </p>\n                )}\n              </div>\n              <div className='modal-footer'>\n                <button\n                  type='button'\n                  className='btn btn-secondary'\n                  data-dismiss='modal'\n                >\n                  Close\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </small>\n    );\n  } else {\n    return null;\n  }\n};\n\nexport default JobHistory;\n"]},"metadata":{},"sourceType":"module"}