{"ast":null,"code":"var _jsxFileName = \"/Users/BleuDChan/ReposBSC/autosubmitreact/src/components/context/graph/GraphState.js\";\nimport React, { useReducer, useContext } from \"react\";\nimport axios from \"axios\";\nimport GraphContext from \"./graphContext\";\nimport GraphReducer from \"./graphReducer\";\nimport ExperimentContext from \"../experiment/experimentContext\";\nimport { sleep } from \"../utils\";\nimport { GET_GRAPH, GET_PKL_DATA, CLEAN_GRAPH_DATA, CLEAN_ONLY_GRAH_DATA, SET_LOADING_GRAPH, SET_AUTOUPDATE_PKL, SET_VIS_DATA, SET_VIS_NETWORK, UPDATE_SELECTION, SET_FOUND_NODES, SET_LOADING_SEARCH_JOB, SET_LOADING_PKL, SHOULD_UPDATE_GRAPH, SET_LOADING_JOB_MONITOR, SET_CURRENT_COMMAND, SET_CURRENT_TEXT_COMMAND, NAVIGATE_GRAPH_TO, CLEAN_PKL_DATA, CLEAN_NAV_DATA, NAVIGATE_AFTER_LOADING_GRAPH, NAVIGATE_TO_GROUP_GRAPH, NAVIGATE_TO_LATEST, UPDATE_GRAPH_SELECTED_NODES, SET_NOTIFICATION_TITLE_GRAPH, SET_OFF_LOADING_GRAPH //DEACTIVATE_COPY_TO,\n} from \"../types\";\nimport { AUTOSUBMIT_API_SOURCE, DEBUG, NOAPI } from \"../vars\"; //import { timeStampToDate } from \"../utils\";\n\nconst GraphState = props => {\n  const initialState = {\n    data: null,\n    visNodes: null,\n    visNetwork: null,\n    loadingGraph: false,\n    loadingPkl: false,\n    loadingJobMonitor: false,\n    enabledGraphSearch: true,\n    loadingSearchJob: false,\n    startAutoUpdatePkl: false,\n    shouldUpdateGraph: false,\n    pklchanges: null,\n    notificationTitleGraph: null,\n    //currentSelected: [],\n    currentCommandGraph: null,\n    current_grouped: \"none\",\n    current_layout: \"standard\",\n    selection: null,\n    foundNodes: null,\n    graphSelectedNodes: null,\n    pkldata: null\n  };\n  const [state, dispatch] = useReducer(GraphReducer, initialState);\n  const localserver = AUTOSUBMIT_API_SOURCE; //const localserver = \"http://84.88.185.94:8081\";\n\n  const debug = DEBUG;\n  const experimentContext = useContext(ExperimentContext);\n  const {\n    updateExperimentTimeStamp,\n    experimentRunning\n  } = experimentContext; // Get Experiment Graph\n\n  const getExperimentGraph = async (expid, grouped = \"none\", layout = \"standard\") => {\n    cleanOnlyGraphData();\n    setLoadingGraph();\n    let result = null;\n\n    if (NOAPI) {\n      //res = {data: null};\n      result = require(\"../data/graph_\" + String(expid) + \"_standard_\" + String(grouped) + \".json\"); //console.log(res.data);\n\n      await sleep(1000);\n    } else {\n      const res = await axios.get(`${localserver}/graph/${expid}/${layout}/${grouped}`).catch(error => {\n        alert(error.message);\n        setOffLoadingGraph();\n      });\n      result = res ? res.data : null;\n    }\n\n    if (result) {\n      debug && console.log(result); //const resdata = res.data;\n\n      dispatch({\n        type: GET_GRAPH,\n        payload: {\n          resdata: result,\n          grouped,\n          layout\n        }\n      });\n    }\n  }; // Get Experiment Pkl Data for Graph changes update\n\n\n  const getExperimentPkl = async (expid, timeStamp) => {\n    // if (state.isGrouped === false){\n    if (experimentRunning === false) return;\n    setLoadingPkl();\n    setLoadingJobMonitor(); //timeStamp = 1000;\n\n    debug && console.log(\"Exp: \" + expid + \"\\t\" + timeStamp + \"\\t\" + experimentRunning);\n    let retrievedPkl = null;\n\n    if (NOAPI) {\n      retrievedPkl = require(\"../data/pklinfo_\" + String(expid) + \".json\");\n    } else {\n      const res = await axios.get(`${localserver}/pklinfo/${expid}/${timeStamp}`);\n      debug && console.log(res.data);\n      retrievedPkl = res.data;\n    }\n\n    dispatch({\n      type: GET_PKL_DATA,\n      payload: retrievedPkl\n    });\n    updateExperimentTimeStamp(retrievedPkl.pkl_timestamp);\n  };\n\n  const navigateAfterLoadGraph = (running = false) => {\n    debug && console.log(\"Nav. After Loading\");\n    dispatch({\n      type: NAVIGATE_AFTER_LOADING_GRAPH,\n      payload: running\n    });\n  };\n\n  const navigateTo = Id => {\n    debug && console.log(\"Nav. To\");\n    dispatch({\n      type: NAVIGATE_GRAPH_TO,\n      payload: Id\n    });\n  };\n\n  const navToLatest = (statusCode, latest) => {\n    debug && console.log(\"Nav. To Latest\");\n    dispatch({\n      type: NAVIGATE_TO_LATEST,\n      payload: {\n        status: statusCode,\n        latest: latest\n      }\n    });\n  };\n\n  const navigateToGroup = IdList => {\n    debug && console.log(\"Nav. To Group.\");\n    dispatch({\n      type: NAVIGATE_TO_GROUP_GRAPH,\n      payload: IdList\n    });\n  };\n\n  const searchJobInGraph = async string => {\n    setLoadingSearchJob();\n    dispatch({\n      type: SET_FOUND_NODES,\n      payload: string.toUpperCase()\n    });\n  };\n\n  const setCurrentCommandGraph = async command => {\n    // for change status\n    //let arrayNames = [];\n    //console.log(command);\n    dispatch({\n      type: SET_CURRENT_COMMAND,\n      payload: command\n    });\n  }; // Clean state data\n\n\n  const cleanOnlyGraphData = () => dispatch({\n    type: CLEAN_ONLY_GRAH_DATA\n  });\n\n  const cleanGraphData = () => dispatch({\n    type: CLEAN_GRAPH_DATA\n  });\n\n  const cleanPklData = () => dispatch({\n    type: CLEAN_PKL_DATA\n  });\n\n  const cleanNavData = () => dispatch({\n    type: CLEAN_NAV_DATA\n  }); // Loading\n\n\n  const setLoadingGraph = () => dispatch({\n    type: SET_LOADING_GRAPH\n  });\n\n  const setOffLoadingGraph = () => dispatch({\n    type: SET_OFF_LOADING_GRAPH\n  });\n\n  const setLoadingSearchJob = () => dispatch({\n    type: SET_LOADING_SEARCH_JOB\n  });\n\n  const setLoadingPkl = () => dispatch({\n    type: SET_LOADING_PKL\n  });\n\n  const setLoadingJobMonitor = () => dispatch({\n    type: SET_LOADING_JOB_MONITOR\n  }); // Set Data\n\n\n  const setAutoUpdatePkl = value => dispatch({\n    type: SET_AUTOUPDATE_PKL,\n    payload: value\n  });\n\n  const setVisData = value => dispatch({\n    type: SET_VIS_DATA,\n    payload: value\n  });\n\n  const setVisNetwork = value => dispatch({\n    type: SET_VIS_NETWORK,\n    payload: value\n  });\n\n  const setUpdateGraph = value => dispatch({\n    type: SHOULD_UPDATE_GRAPH,\n    payload: value\n  });\n\n  const updateSelection = currentSelection => dispatch({\n    type: UPDATE_SELECTION,\n    payload: currentSelection\n  });\n\n  const updateGraphSelectedNodes = () => dispatch({\n    type: UPDATE_GRAPH_SELECTED_NODES\n  });\n\n  const setNotificationTitleGraph = notification => dispatch({\n    type: SET_NOTIFICATION_TITLE_GRAPH,\n    payload: notification\n  }); //const deactivateCanCopyTo = () => dispatch({ type: DEACTIVATE_COPY_TO });\n\n\n  return /*#__PURE__*/React.createElement(GraphContext.Provider, {\n    value: {\n      visNetwork: state.visNetwork,\n      data: state.data,\n      loadingGraph: state.loadingGraph,\n      loadingPkl: state.loadingPkl,\n      loadingJobMonitor: state.loadingJobMonitor,\n      pklchanges: state.pklchanges,\n      enabledGraphSearch: state.enabledGraphSearch,\n      current_grouped: state.current_grouped,\n      current_layout: state.current_layout,\n      selection: state.selection,\n      foundNodes: state.foundNodes,\n      pkldata: state.pkldata,\n      startAutoUpdatePkl: state.startAutoUpdatePkl,\n      shouldUpdateGraph: state.shouldUpdateGraph,\n      graphSelectedNodes: state.graphSelectedNodes,\n      currentCommandGraph: state.currentCommandGraph,\n      notificationTitleGraph: state.notificationTitleGraph,\n      getExperimentGraph,\n      getExperimentPkl,\n      cleanOnlyGraphData,\n      cleanGraphData,\n      setLoadingGraph,\n      setUpdateGraph,\n      setVisData,\n      setVisNetwork,\n      updateSelection,\n      cleanPklData,\n      searchJobInGraph,\n      cleanNavData,\n      setAutoUpdatePkl,\n      navigateToGroup,\n      navigateTo,\n      navToLatest,\n      navigateAfterLoadGraph,\n      updateGraphSelectedNodes,\n      setCurrentCommandGraph,\n      setNotificationTitleGraph\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 5\n    }\n  }, props.children);\n};\n\nexport default GraphState;","map":{"version":3,"sources":["/Users/BleuDChan/ReposBSC/autosubmitreact/src/components/context/graph/GraphState.js"],"names":["React","useReducer","useContext","axios","GraphContext","GraphReducer","ExperimentContext","sleep","GET_GRAPH","GET_PKL_DATA","CLEAN_GRAPH_DATA","CLEAN_ONLY_GRAH_DATA","SET_LOADING_GRAPH","SET_AUTOUPDATE_PKL","SET_VIS_DATA","SET_VIS_NETWORK","UPDATE_SELECTION","SET_FOUND_NODES","SET_LOADING_SEARCH_JOB","SET_LOADING_PKL","SHOULD_UPDATE_GRAPH","SET_LOADING_JOB_MONITOR","SET_CURRENT_COMMAND","SET_CURRENT_TEXT_COMMAND","NAVIGATE_GRAPH_TO","CLEAN_PKL_DATA","CLEAN_NAV_DATA","NAVIGATE_AFTER_LOADING_GRAPH","NAVIGATE_TO_GROUP_GRAPH","NAVIGATE_TO_LATEST","UPDATE_GRAPH_SELECTED_NODES","SET_NOTIFICATION_TITLE_GRAPH","SET_OFF_LOADING_GRAPH","AUTOSUBMIT_API_SOURCE","DEBUG","NOAPI","GraphState","props","initialState","data","visNodes","visNetwork","loadingGraph","loadingPkl","loadingJobMonitor","enabledGraphSearch","loadingSearchJob","startAutoUpdatePkl","shouldUpdateGraph","pklchanges","notificationTitleGraph","currentCommandGraph","current_grouped","current_layout","selection","foundNodes","graphSelectedNodes","pkldata","state","dispatch","localserver","debug","experimentContext","updateExperimentTimeStamp","experimentRunning","getExperimentGraph","expid","grouped","layout","cleanOnlyGraphData","setLoadingGraph","result","require","String","res","get","catch","error","alert","message","setOffLoadingGraph","console","log","type","payload","resdata","getExperimentPkl","timeStamp","setLoadingPkl","setLoadingJobMonitor","retrievedPkl","pkl_timestamp","navigateAfterLoadGraph","running","navigateTo","Id","navToLatest","statusCode","latest","status","navigateToGroup","IdList","searchJobInGraph","string","setLoadingSearchJob","toUpperCase","setCurrentCommandGraph","command","cleanGraphData","cleanPklData","cleanNavData","setAutoUpdatePkl","value","setVisData","setVisNetwork","setUpdateGraph","updateSelection","currentSelection","updateGraphSelectedNodes","setNotificationTitleGraph","notification","children"],"mappings":"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","sourcesContent":["import React, { useReducer, useContext } from \"react\";\nimport axios from \"axios\";\nimport GraphContext from \"./graphContext\";\nimport GraphReducer from \"./graphReducer\";\nimport ExperimentContext from \"../experiment/experimentContext\";\nimport { sleep } from \"../utils\";\n\nimport {\n  GET_GRAPH,\n  GET_PKL_DATA,\n  CLEAN_GRAPH_DATA,\n  CLEAN_ONLY_GRAH_DATA,\n  SET_LOADING_GRAPH,\n  SET_AUTOUPDATE_PKL,\n  SET_VIS_DATA,\n  SET_VIS_NETWORK,\n  UPDATE_SELECTION,\n  SET_FOUND_NODES,\n  SET_LOADING_SEARCH_JOB,\n  SET_LOADING_PKL,\n  SHOULD_UPDATE_GRAPH,\n  SET_LOADING_JOB_MONITOR,\n  SET_CURRENT_COMMAND,\n  SET_CURRENT_TEXT_COMMAND,\n  NAVIGATE_GRAPH_TO,\n  CLEAN_PKL_DATA,\n  CLEAN_NAV_DATA,\n  NAVIGATE_AFTER_LOADING_GRAPH,\n  NAVIGATE_TO_GROUP_GRAPH,\n  NAVIGATE_TO_LATEST,\n  UPDATE_GRAPH_SELECTED_NODES,\n  SET_NOTIFICATION_TITLE_GRAPH,\n  SET_OFF_LOADING_GRAPH,\n  //DEACTIVATE_COPY_TO,\n} from \"../types\";\n\nimport { AUTOSUBMIT_API_SOURCE, DEBUG, NOAPI } from \"../vars\";\n\n//import { timeStampToDate } from \"../utils\";\n\nconst GraphState = (props) => {\n  const initialState = {\n    data: null,\n    visNodes: null,\n    visNetwork: null,\n    loadingGraph: false,\n    loadingPkl: false,\n    loadingJobMonitor: false,\n    enabledGraphSearch: true,\n    loadingSearchJob: false,\n    startAutoUpdatePkl: false,\n    shouldUpdateGraph: false,\n    pklchanges: null,\n    notificationTitleGraph: null,\n    //currentSelected: [],\n    currentCommandGraph: null,\n    current_grouped: \"none\",\n    current_layout: \"standard\",\n    selection: null,\n    foundNodes: null,\n    graphSelectedNodes: null,\n    pkldata: null,\n  };\n\n  const [state, dispatch] = useReducer(GraphReducer, initialState);\n  const localserver = AUTOSUBMIT_API_SOURCE;\n  //const localserver = \"http://84.88.185.94:8081\";\n  const debug = DEBUG;\n\n  const experimentContext = useContext(ExperimentContext);\n  const { updateExperimentTimeStamp, experimentRunning } = experimentContext;\n\n  // Get Experiment Graph\n  const getExperimentGraph = async (\n    expid,\n    grouped = \"none\",\n    layout = \"standard\"\n  ) => {\n    cleanOnlyGraphData();\n    setLoadingGraph();\n    let result = null;\n    if (NOAPI) {\n      //res = {data: null};\n      result = require(\"../data/graph_\"+String(expid)+\"_standard_\"+String(grouped)+\".json\");\n      //console.log(res.data);\n      await sleep(1000);\n    } else {\n      const res = await axios\n      .get(`${localserver}/graph/${expid}/${layout}/${grouped}`)\n      .catch((error) => {\n        alert(error.message);\n        setOffLoadingGraph();\n      });\n      result = res ? res.data : null;\n    }\n    \n    if (result) {\n      debug && console.log(result);\n      //const resdata = res.data;\n      dispatch({\n        type: GET_GRAPH,\n        payload: { resdata: result, grouped, layout },\n      });\n    }\n  };\n\n  // Get Experiment Pkl Data for Graph changes update\n  const getExperimentPkl = async (expid, timeStamp) => {\n    // if (state.isGrouped === false){\n    if (experimentRunning === false) return;\n    setLoadingPkl();\n    setLoadingJobMonitor();\n    //timeStamp = 1000;\n    debug &&\n      console.log(\n        \"Exp: \" + expid + \"\\t\" + timeStamp + \"\\t\" + experimentRunning\n      );\n    let retrievedPkl = null;\n    if (NOAPI){\n      retrievedPkl = require(\"../data/pklinfo_\"+String(expid)+\".json\");\n    } else {\n      const res = await axios.get(`${localserver}/pklinfo/${expid}/${timeStamp}`);\n      debug && console.log(res.data);\n      retrievedPkl = res.data;\n    } \n    \n    dispatch({\n      type: GET_PKL_DATA,\n      payload: retrievedPkl,\n    });\n\n    updateExperimentTimeStamp(retrievedPkl.pkl_timestamp);\n  };\n\n  const navigateAfterLoadGraph = (running = false) => {\n    debug && console.log(\"Nav. After Loading\");\n    dispatch({ type: NAVIGATE_AFTER_LOADING_GRAPH, payload: running });\n  };\n\n  const navigateTo = (Id) => {\n    debug && console.log(\"Nav. To\");\n    dispatch({ type: NAVIGATE_GRAPH_TO, payload: Id });\n  };\n\n  const navToLatest = (statusCode, latest) => {\n    debug && console.log(\"Nav. To Latest\");\n    dispatch({\n      type: NAVIGATE_TO_LATEST,\n      payload: { status: statusCode, latest: latest },\n    });\n  };\n\n  const navigateToGroup = (IdList) => {\n    debug && console.log(\"Nav. To Group.\");\n    dispatch({\n      type: NAVIGATE_TO_GROUP_GRAPH,\n      payload: IdList,\n    });\n  };\n\n  const searchJobInGraph = async (string) => {\n    setLoadingSearchJob();\n    dispatch({\n      type: SET_FOUND_NODES,\n      payload: string.toUpperCase(),\n    });\n  };\n\n  const setCurrentCommandGraph = async (command) => {\n    // for change status\n    //let arrayNames = [];\n\n    //console.log(command);\n    dispatch({\n      type: SET_CURRENT_COMMAND,\n      payload: command,\n    });\n  };\n\n  // Clean state data\n  const cleanOnlyGraphData = () => dispatch({ type: CLEAN_ONLY_GRAH_DATA });\n  const cleanGraphData = () => dispatch({ type: CLEAN_GRAPH_DATA });\n  const cleanPklData = () => dispatch({ type: CLEAN_PKL_DATA });\n  const cleanNavData = () => dispatch({ type: CLEAN_NAV_DATA });\n  // Loading\n  const setLoadingGraph = () => dispatch({ type: SET_LOADING_GRAPH });\n  const setOffLoadingGraph = () => dispatch({ type: SET_OFF_LOADING_GRAPH });\n  const setLoadingSearchJob = () => dispatch({ type: SET_LOADING_SEARCH_JOB });\n  const setLoadingPkl = () => dispatch({ type: SET_LOADING_PKL });\n  const setLoadingJobMonitor = () =>\n    dispatch({ type: SET_LOADING_JOB_MONITOR });\n\n  // Set Data\n  const setAutoUpdatePkl = (value) =>\n    dispatch({ type: SET_AUTOUPDATE_PKL, payload: value });\n  const setVisData = (value) =>\n    dispatch({ type: SET_VIS_DATA, payload: value });\n  const setVisNetwork = (value) =>\n    dispatch({ type: SET_VIS_NETWORK, payload: value });\n  const setUpdateGraph = (value) =>\n    dispatch({ type: SHOULD_UPDATE_GRAPH, payload: value });\n  const updateSelection = (currentSelection) =>\n    dispatch({ type: UPDATE_SELECTION, payload: currentSelection });\n  const updateGraphSelectedNodes = () =>\n    dispatch({ type: UPDATE_GRAPH_SELECTED_NODES });\n  const setNotificationTitleGraph = (notification) =>\n    dispatch({ type: SET_NOTIFICATION_TITLE_GRAPH, payload: notification });\n  //const deactivateCanCopyTo = () => dispatch({ type: DEACTIVATE_COPY_TO });\n\n  return (\n    <GraphContext.Provider\n      value={{\n        visNetwork: state.visNetwork,\n        data: state.data,\n        loadingGraph: state.loadingGraph,\n        loadingPkl: state.loadingPkl,\n        loadingJobMonitor: state.loadingJobMonitor,\n        pklchanges: state.pklchanges,\n        enabledGraphSearch: state.enabledGraphSearch,\n        current_grouped: state.current_grouped,\n        current_layout: state.current_layout,\n        selection: state.selection,\n        foundNodes: state.foundNodes,\n        pkldata: state.pkldata,\n        startAutoUpdatePkl: state.startAutoUpdatePkl,\n        shouldUpdateGraph: state.shouldUpdateGraph,\n        graphSelectedNodes: state.graphSelectedNodes,\n        currentCommandGraph: state.currentCommandGraph,\n        notificationTitleGraph: state.notificationTitleGraph,\n        getExperimentGraph,\n        getExperimentPkl,\n        cleanOnlyGraphData,\n        cleanGraphData,\n        setLoadingGraph,\n        setUpdateGraph,\n        setVisData,\n        setVisNetwork,\n        updateSelection,\n        cleanPklData,\n        searchJobInGraph,\n        cleanNavData,\n        setAutoUpdatePkl,\n        navigateToGroup,\n        navigateTo,\n        navToLatest,\n        navigateAfterLoadGraph,\n        updateGraphSelectedNodes,\n        setCurrentCommandGraph,\n        setNotificationTitleGraph,\n      }}\n    >\n      {props.children}\n    </GraphContext.Provider>\n  );\n};\n\nexport default GraphState;\n"]},"metadata":{},"sourceType":"module"}